add_subdirectory(vendor)

add_library(Engine STATIC)

file(GLOB_RECURSE ENGINE_SOURCES 
    "${CMAKE_CURRENT_SOURCE_DIR}/Source/*.cpp"
    "${CMAKE_CURRENT_SOURCE_DIR}/Source/*.h"
    "${CMAKE_CURRENT_SOURCE_DIR}/Platform/*.cpp"
    "${CMAKE_CURRENT_SOURCE_DIR}/Platform/*.h"
)
source_group(TREE "${CMAKE_CURRENT_SOURCE_DIR}" FILES ${ENGINE_SOURCES})

target_sources(Engine
    PRIVATE
        ${ENGINE_SOURCES}
        ${CMAKE_CURRENT_SOURCE_DIR}/vendor/stb/stb_image.cpp
	"${CMAKE_CURRENT_SOURCE_DIR}/vendor/SPIRV-Reflect/spirv_reflect.h"
	"${CMAKE_CURRENT_SOURCE_DIR}/vendor/SPIRV-Reflect/spirv_reflect.cpp"
    PUBLIC
        FILE_SET HEADERS
        TYPE HEADERS
        BASE_DIRS "${CMAKE_CURRENT_SOURCE_DIR}/Source"
        FILES "${CMAKE_CURRENT_SOURCE_DIR}/Source/hepch.h"
)

target_include_directories(Engine
    PUBLIC
        $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/Source>
        $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/Platform>
	${CMAKE_CURRENT_SOURCE_DIR}/vendor/spdlog
	${CMAKE_CURRENT_SOURCE_DIR}/vendor/SPIRV-Reflect
	${CMAKE_CURRENT_SOURCE_DIR}/vendor/entt/include
        ${CMAKE_CURRENT_SOURCE_DIR}/vendor/GLFW/include
        ${CMAKE_CURRENT_SOURCE_DIR}/vendor/imgui
        ${CMAKE_CURRENT_SOURCE_DIR}/vendor/glm
        ${CMAKE_CURRENT_SOURCE_DIR}/vendor/assimp/include
        ${CMAKE_CURRENT_SOURCE_DIR}/vendor/stb/
	${CMAKE_CURRENT_SOURCE_DIR}/vendor/yaml-cpp/include
        ${VULKAN_INCLUDE_DIR}
)

target_link_libraries(Engine 
    PRIVATE
        glfw
        ImGui
        assimp
	yaml-cpp
        ${VULKAN_LIB}
        ${SHADERC_LIB}
        ${SPIRV_CROSS_CORE_LIB}
        ${SPIRV_CROSS_GLSL_LIB}
        ${SPIRV_TOOLS_LIB}
)

target_compile_options(Engine PRIVATE /utf-8)
target_compile_definitions(Engine PUBLIC SPIRV_REFLECT_USE_SYSTEM_SPIRV_H)
target_precompile_headers(Engine
    PRIVATE
        "${CMAKE_CURRENT_SOURCE_DIR}/Source/hepch.h"
)
